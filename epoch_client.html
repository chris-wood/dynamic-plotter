<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Athena Dashboard</title>

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/epoch.min.css">

        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/d3.js"></script>
        <script src="js/epoch.min.js"></script>
        <script src="js/data.js"></script>
    </head>

    <!-- TODO angularize this app -->
    <body>
        <div class="container">

            <!-- TODO add banner here -->
            <!-- TODO add login -->

            <div class="row">
                <div class="col-md-2">
                    <h5>CCNx Forwarder Dashboard</h5>
                    <br/>

                    <h5>Overall Statistics</h5>
                    <ul class="nav nav-pills nav-stacked">
                        <!-- TODO: make this a checkbox -->
                        <li><a href="#">Cache Size</a></li>
                        <li><a href="#">Cache Hits</a></li>
                        <li><a href="#">PIT Size</a></li>
                        <li><a href="#">PIT Entry Lifetime</a></li>
                    </ul>
                    <hr/>

                    <h5>Message Rates</h5>
                    <ul class="nav nav-pills nav-stacked">
                        <!-- TODO: make this a checkbox -->
                        <li><a href="#">Interest</a></li>
                        <li><a href="#">Content Object</a></li>
                        <li><a href="#">Control</a></li>
                        <li><a href="#">Interest Return</a></li>
                    </ul>
                    <hr/>

                    <h5>Other</h5>
                    <ul class="nav nav-pills nav-stacked">
                        <!-- TODO: make this a checkbox -->
                        <li><a href="#">Topology</a></li>
                        <li><a href="#">FIB Contents</a></li>
                        <li><a href="#">Daemon Log</a></li>
                    </ul>
                    <hr/>

                    <h5>Version Information</h5>
                    <ul class="nav nav-pills nav-stacked">
                        <li>Athena: </li>
                        <li>CS: </li>
                        <li>PIT: </li>
                    </ul>
                </div>

                <div>
                    <h3 style="text-align:center">Forwarder Statistics</h3>

                    <div class="col-md-5" style="text-align:center">
                        <h4>CS Size</h4>
                        <div id="cache-size" class="epoch category10" style="height: 200px;"></div>
                        <hr/>

                        <h4>CS Hits</h4>
                        <div id="cache-hits" class="epoch category10" style="height: 200px;"></div>
                        <hr/>

                    </div>

                    <div class="col-md-5" style="text-align:center">

                        <h4>PIT Size</h4>
                        <div id="pit-size" class="epoch category10" style="height: 200px;"></div>
                        <hr/>

                        <h4>PIT Entry Lifetime</h4>
                        <div id="pit-lifetime" class="epoch category10" style="height: 200px;"></div>
                        <hr/>
                    </div>
                </div>

                <div>
                    <div class="col-md-10 col-md-offset-2" style="text-align:center; display: inline-block" >
                        <h3 style="text-align:center">Overall Message Rates</h3>

                        <div class="col-md-3" style="text-align:center">
                            <h5>Interest Messages</h5>
                            <div id="overall-interest" class="epoch gauge-tiny"></div>
                        </div>

                        <div class="col-md-3" style="text-align:center">
                            <h5 style="display: inline-block">Content Messages</h5>
                            <div id="overall-content" class="epoch gauge-tiny"></div>
                        </div>

                        <div class="col-md-3" style="text-align:center">
                            <h5>Control Messages</h5>
                            <div id="overall-control" class="epoch gauge-tiny"></div>
                        </div>

                        <div class="col-md-3" style="text-align:center">
                            <h5>Int. Return Messages</h5>
                            <div id="overall-interestreturn" class="epoch gauge-tiny"></div>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="col-md-10 col-md-offset-2" style="text-align:center; display: inline-block">
                        <h3>Topology</h3>

                        <!-- TODO: plot the topology here (as a labeled graph),
                             TODO: and show fitlerable table with FIB contents -->
                    </div>
                </div>

                <div>
                    <div class="col-md-10 col-md-offset-2" style="text-align:center; display: inline-block">
                        <h3>Log</h3>

                        <!-- TODO: make it kind of pretty, and how the heck would we get the data from the log? -->
                    </div>
                </div>
            </div>
        </div>

        <footer style="text-align:center">
            <!-- TODO: logo here -->
            copyright PARC (logo!)
        </footer>
    </body>

    <script>

        function plotGuageChart(id, dataUrl) {
            var data = new RealTimeData(4);
            var chart = $(id).epoch({
                type: 'time.gauge',
                value: 0.5,
            });

            setInterval(function() {
                $.ajax({
                    url: dataUrl,
                    type: "GET",
                    jsonp: "callback",
                    dataType: "jsonp",

                    success: function(response) {
                        point = response;
                        console.log(point[0]["y"]);
                        chart.update(parseFloat(point[0]["y"]));
                    }
                });
            }, 1000);
        }

        function plotChart(chartType, id, dataUrl) {
            var data = new RealTimeData(1);
            var chart = $(id).epoch({
                type: chartType,
                data: data.history(),
                axes: ['left', 'bottom', 'right']
            });

            setInterval(function() {
                $.ajax({
                    url: dataUrl,
                    type: "GET",
                    jsonp: "callback",
                    dataType: "jsonp",

                    success: function(response) {
                        point = response;
                        chart.push(point);
                    }
                });
            }, 1000);
        }

        plotChart('time.line', "#cache-size", "http://localhost:5000/cache-size");
        plotChart('time.line', "#cache-hits", "http://localhost:5000/cache-hits");
        plotChart('time.line', "#pit-size", "http://localhost:5000/pit-size");
        plotChart('time.line', "#pit-lifetime", "http://localhost:5000/pit-lifetime");

        plotGuageChart("#overall-interest", "http://localhost:5000/overall-interest");
        plotGuageChart("#overall-content", "http://localhost:5000/overall-content");
        plotGuageChart("#overall-control", "http://localhost:5000/overall-control");
        plotGuageChart("#overall-interestreturn", "http://localhost:5000/overall-interestreturn");
    </script>
</html>
